## 多表关系

- 一对多(多对一)
- 多对多
- 一对一

## 多表查询概述

- 概述：指从多张表中查询数据
- 笛卡尔积：笛卡尔乘积是指在数学中，两个集合A和集合B的所有组合情况（在多表查询时，需要消除无效的笛卡尔积）
- 多表查询分类
  - 连接查询
    - 内连接：相当于查询A, B交集部分数据
    - 外连接：左外连接：查询左表所有数据，以及两张表交集部分数据；右外连接：查询右表所有数据，以及两张表交集部分数据
    - 自连接：当前表与自身的连接查询，自连接必须使用表别名
  - 子查询

## 内连接

- 隐式内连接 `select 字段列表 from 表1,表2 where 条件...`
- 显示内连接 `select 字段列表 from 表1 [INNER] join 表2 on 连接条件;`
- 内连接查询的是两张表交集的部分

## 外连接

- 左外连接： `select 字段列表 from 表1 left [outer] join 表2 on 条件`相当于查询表1(左表)的所有数据包含表1和表2交集部分的数据
- 右外连接：`select 字段列表 from 表1 right [outer] join 表2 on 条件`

## 自连接

- `select 字段列表 from 表A 别名A join 表A 别名B on 条件`自连接查询可以是内连接查询，也可以是外连接查询

## 联合查询 union, union all

- 对于union查询，就是把多次查询的结果合并起来，形成一个新的查询结果集

```sql
SELECT 字段列表 FROM 表 A ...
UNION ALL
SELECT 字段列表 FROM 表 B ...
```

- 对于联合查询的多张表的列数必须保持一致，字段类型也需要保持一致
- union all会将全部的数据直接合并在一起, union会对合并之后的数据去重

## 子查询

- 概念：SQL语句中嵌套SELECT语句，称为嵌套查询，又称子查询

```sql
SELECT * FROM t1 WHERE column1 = (SELECT column1 FROM t2);
```

- 子查询外部的语句可以是INSERT/UPDATE/DELTE/SELECT的任何一个
- 根据子查询结果不同，分为：
  - 标量子查询（子查询结果为单个值）
  - 列子查询（子查询结果为一列）
  - 行子查询（子查询结果为一行）
  - 表子查询（子查询结果为多行多列）
- 根据子查询位置，分为：WHERE之后，FROM之后，SELECT之后

## 多表查询案例