## 移位指令

- SHL OPR, CNT 将OPR逻辑左移CNT位
  - 将寄存器或内存单元中的数据左移
  - 将最后移出的一位写入CF中
  - 最低位用0补充
- shl指令示例

```assembly
mov al, 01010001b
mov cl, 3   ; 移动位数大于1时，必须用cl
shl al, cl  ; 结果(al)=10001000b, CF=0
```

- s将x逻辑左移一位，相当于执行x=x*2; 右移一位，相当于执行x=x/2

```assembly
mov al, 0000 0001b
shl al, 1           ; (al)=0000 0010b
shl al, 1           ; (al)=0000 0100b
shl al, 1           ; (al)=0000 1000b
mov cl, 3
shl al, cl          ; (al)=0100 0000b
mov cl, 2
shr al, cl          ; (al)=0001 0000b
```

## 操作显存数据

#### 显示的原理

- 屏幕上的内容 = 显存中的数据

![](./images/显示原理.png)

### 显示缓冲区的结构

![](./images/显示缓冲区的结构.jpg)

### 显示信息的一种“直接方式”

- 编程序，在屏幕的中间，白底黑字，显示'Welcome to masm!'

```assembly
assume cs:code, ds:data
data segment
    db 'Welcome to masm!'
data ends
code segment
start:
    ; 初始化寄存器
    mov ax, data
    mov ds, ax
    mov ax, 0b800h
    mov es, ax
    mov si, 0
    mov di, 160 * 12 + 80 - 16

    ; 显示字符串
    mov cx, 16
w:
    mov al, [si]
    mov es:[di], al
    inc di
    mov al, 71h  ;01110001
    mov es:[di], al
    inc si
    inc di
    loop w

    mov ax, 4c00h
    int 21h
code ends
end start
```

## 描述内存单元的标号

### 关于标号

- 代码段中的标号可以用来标记指令、段的起始地址
- 代码段中的数据也可以用标号

```assembly
assume cs:code
code segment
start:
	mov ax, 1
	mov cx, 8
s:
	add ax, ax
	loop s
	mov ax, 4c00h
	int 21h
code ends
end start
```

- 将a标号处的8个字节数据累加，结果存储到b标号处的字节中

```assembly
assume cs:code
code segment
	a: db 1,2,3,4,5,6,7,8
	b: dw 0
start:
	mov si, offset a
	mov bx, offset b
	mov cx, 8
s:
	mov al, cs:[si]
	mov ah, 0
	add cs:[bx], ax
	inc si
	loop s
	mov ax, 4c00h
	int 21h
code ends
end start
```

### 去了冒号的数据标号

- 数据标号
  - 数据标号标记了存储数据的单元的地址和长度
  - 数据标号不同于仅仅表示地址的地址标号

```assembly
assume cs:code
code segment
	a db 1,2,3,4,5,6,7,8
	b dw 0
start:
	mov si, 0
	mov cx, 8
s:
	mov al, a[si]
	mov ah, 0
	add b, ax
	inc si
	loop s
	mov ax, 4c00h
	int 21h
code ends
end start
```

- 我们在code段中使用的标号a, b后面没有加“:”, 他们同时描述内存地址和单元长度的标号
- 标号a
  - 地址code:0
  - 以后的内存单元都是字节
- 标号b
  - 地址code:8
  - 以后的内存单元都是字

## 数据的直接定址表

## 代码的直接定址表

## 中断及其处理

## 编制中断处理程序

## 单步中断

## 由int指令引发的中断

## BIOS和DOS中断处理

## 端口的读写

## 操作CMOS RAM芯片

## 外设连接与中断

## PC机键盘的处理过程

## 定制键盘输入处理

## 改写中断例程的方法

## 用中断响应外设

## 应用：字符串的输入

## 磁盘读写

## 发声程序

