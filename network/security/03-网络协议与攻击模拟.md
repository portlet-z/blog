## 协议

TCP/IP 协议族

- 网络接口层(没有特定的协议): PPPOE, 物理层，数据链路层
- 网络层: IP(4,6), ARP(地址解析协议)，RARP ICMP(Internet控制报文协议) IGMP
- 传输层: TCP(传输控制协议)  UDP(用户数据报协议)
- 应用层：都是基于传输层协议的端口，总共0-65535  DHCP  DNS  HTTP HTTPS FTP SMTP POP3 IMAP

## 流量抓取工具wireshark

### 一、网卡

#### 网卡模式

- 混杂模式：不管目的是否是自己，都接收
- 非混杂模式：默认情况下，主机的网卡处于此模式，不会接收目的非自己的数据

#### 界面认识

#### 两种过滤器

- 捕获过滤器：在抓包之前先进行过滤（只抓某种类型的包或者不抓某些类型的包）
- 显示过滤器：抓包前抓包后都可以进行过滤，但是不影响抓取的包（会抓取所有的包，只不过在查看的时候只显示某些包）

#### 过滤器

- 捕获过滤器

  - 类型：host  net  port
  - 方向：src  dst
  - 协议：ether  ip  tcp  udp  http  ftp ...
  - 逻辑运算符: &&  ||  !

  ```powershell
  #抓取源 IP为 192.168.18.14并且目标端口为 80 的报文
  src host 192.168.18.14 && dst port 80
  #抓取 IP 为 192.168.18.14或者 IP 地址为 192.168.18.1
  host 192.168.18.14 || host 192.168.18.1
  #抓取非广播包
  !broadcast
  #抓取源 IP 为 192.168.18.14或者源192.168.18.0/24， 目的 TCP 端口号在 200-1000 之间，并且目的位于129.0.0.0/8
  (src host 192.168.18.14 || src 192.168.18.0/24) && (dst portrange 200-1000 && dst net 129.0.0.0/8)
  ```

- 显示过滤器

  - 比较操作符： ==(eq), !=(neq), >(gt), <(lt), >=(ge), <=(le)
  - 逻辑操作符: and(&&), or(||), not
  - IP 地址过滤: ip.addr   ip.src   ip.dst
  - 端口过滤: tcp.port   udp.port   tcp.dstport   tcp.flag.syn   tcp.flag.ack
  - 协议过滤: arp   ip   icmp   udp    tcp   http

  ```powershell
  #显示源 IP 等于 192.168.18.14并且 tcp 端口为 443
  ip.src==192.168.18.14 and tcp.port==443
  #显示源不为 192.168.18.14 或者目的不为 202.98.96.68
  ip.src!=192.168.18.14 or ip.dst!=202.98.96.68
  ```

  