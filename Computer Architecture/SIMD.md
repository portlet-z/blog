### SIMD指令集多媒体扩展

- SIMD多媒体扩展源于一个很容易观察到的事实：许多媒体应用程序操作的数据类型要比对32位处理器进行针对性优化的数据类型更窄一些。许多图形系统使用8位来表示三基色中的每一种颜色，再用8位来表示透明度。根据不同的应用程序，音频采样通常用8位或16位来表示。假定有一个256位加法器，通过划分这个加法器中的进位链，处理器可以同时对一些短向量进行操作，这些向量可以是32个8位操作数、16个16位操作数、8个32位操作数或者4个64位操作数。这些经过划分的加法器的额外成本很小。表4-3总结了典型的多媒体SIMD指令。和向量指令一样，SIMD指令规定了对数据向量的相同操作。一些向量机器拥有大型寄存器堆，比如VMIPS向量寄存器，8个向量寄存器中的每一个都可以保存64个64位元素，SIMD扩展主要进行了以下3项优化

- 多媒体SIMD扩展固定了操作代码中数据操作数的数目，从而在x86体系结构的MMX,SSE和AVX扩展红添加了数百条指令。向量体系结构有一个向量长度寄存器，用于指定当前操作的操作数个数。一些程序的向量长度小于体系结构的最大支持长度，由于这些向量寄存器长度可以变化，所以也能够很轻松的适应此类程序。此外，向量体系结构又一个隐含的最大向量长度，它与向量长度寄存器相结合，可以避免使用大量操作码。

- 多媒体SIMD没有提供向量体系结构的更复杂寻址模式，也就是步幅访问和集中-分散访问。这些功能增加了向量编译器成功向量话的程序数目

- 多媒体SIMD通常不会像向量体系结构那样，为了支持元素的条件执行而提供遮罩寄存器。这些省略增大了编译器生成SIMD代码的难度，也加大了SIMD汇编语言的难度

- 对于x86体系结构，1996年增加的MMX指令重新确定了64位浮点数寄存器的用途，所以基本指令可以同时执行8个8位运算或4个16位运算。这些指令与其他各种指令结合在一起，包括并行MAX和MIN运算、各种遮罩和条件指令、通常在数字信号处理器中进行的运算以及人们想象在重要媒体库中有用的专用指令。注意，MMX重复使用浮点数据传送指令来访问存储器。

- 1999年推出的后续流式SIMD扩展(SSE)添加了原来宽128位的独立寄存器，所以现在的指令可以同时执行16个8位运算、8个16位运算或4个32位运算。它还执行并行单精度浮点数运算。由于SSE拥有独立寄存器，所以它需要独立的数据传送指令。Intel很快在2001年的SSE2,2004年的SSE3和2007年的SSE4中添加了双精度SIMD浮点数据类型。拥有四个单精度浮点数运算或两个并行双精度运算的指令提高了x86计算机的峰值浮点性能，只要程序员将操作数并排放在一起即可。在每一代计算机中都添加了一些专用指令，用于加快一些重要的特定多媒体功能的速度。

- 2010年增加的高级向量扩展AVX再次将寄存器的宽度加倍，变为256位，并提供了一些指令，将针对所有较窄数据类型的运算数目翻了一番。表4-4给出了可用于进行双精度浮点计算的AVX指令。AVX进行了一些准备工作，以便在降了的体系结构中将宽度扩展到512位和1024位。
